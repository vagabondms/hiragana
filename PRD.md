# 히라가나 학습 앱 - Product Requirements Document (PRD)

## 1. 프로젝트 개요
히라가나 문자를 학습하기 위한 웹 기반 플래시카드 애플리케이션

## 2. 핵심 기능 요구사항

### 2.1 카드 시스템
- **카드 구조**: 앞면(한국어) / 뒷면(일본어/히라가나)
- **학습 플로우**:
  1. 초기 상태: 한국어 표시 (카드 앞면)
  2. 첫 번째 클릭/터치: 카드 180도 뒤집기 → 일본어 표시 (카드 뒷면)
  3. 두 번째 클릭/터치: 다음 문제로 전환 (카드 슬라이드 애니메이션)

### 2.2 애니메이션 요구사항
- **카드 플립 애니메이션** (한국어 → 일본어):
  - 180도 Y축 회전
  - 부드러운 3D 전환 효과

- **카드 슬라이드 애니메이션** (일본어 → 다음 한국어):
  - 현재 카드: 일본어가 보이는 상태로 오른쪽으로 슬라이드 아웃
  - 새 카드: 한국어가 보이는 상태로 왼쪽에서 슬라이드 인
  - 두 카드가 독립적으로 관리되어야 함 (dual-card system)

### 2.3 랜덤 알고리즘
- **문제점**: 단순 랜덤 사용 시 같은 글자가 자주 반복됨
- **해결책**: 히스토리 기반 스마트 랜덤
  - 최근 5개 (또는 전체 글자 수의 절반) 글자 기억
  - 최근 나온 글자는 선택 풀에서 제외
  - 모든 글자가 히스토리에 있으면 히스토리 초기화

### 2.4 입력 처리
- **지원 입력 방식**:
  - 스페이스바 (데스크톱)
  - 마우스 클릭
  - 터치 (모바일)

- **애니메이션 잠금**:
  - 카드 플립 중 입력 차단 (600ms)
  - 카드 슬라이드 중 입력 차단 (300ms)
  - isAnimating 플래그로 관리

## 3. 모바일 최적화

### 3.1 반응형 디자인
- **브레이크포인트**:
  - 768px 이하: 태블릿 대응
    - 카드 크기: 90vw (최대 350px)
    - 글자 크기: 80px
  - 480px 이하: 모바일 대응
    - 카드 크기: 90vw (최대 300px)
    - 글자 크기: 60px

- **텍스트 처리**:
  - white-space: nowrap으로 줄바꿈 방지
  - 모바일에서도 한 줄로 표시

### 3.2 터치 이벤트
- 모든 인터랙티브 요소에 터치 이벤트 추가
- preventDefault()로 기본 동작 방지
- 설정 버튼, 모달, 카드 모두 터치 지원

## 4. 설정 기능

### 4.1 행 선택 모달
- 학습할 히라가나 행 선택 (A, K, S, T, N, H, M, Y, R, W)
- 선택된 행은 localStorage에 저장
- 모달 외부 클릭/터치로 닫기 가능

### 4.2 문자 체계 선택 기능
- 히라가나/가타카나 체크박스 추가
- 복수 선택 가능, 최소 1개 이상 선택 필수
- 기존 행 선택 UI와 동일한 디자인 패턴 사용
- localStorage에 선택 상태 저장

### 4.3 카드 문자 체계 표시
- 카드 앞면(한글 표시 부분) 우측 상단에 문자 체계 배지 표시
- "히" (히라가나) 또는 "가" (가타카나)로 구분
- 사용자가 카드를 뒤집기 전에 어떤 문자 체계를 학습할지 미리 확인 가능

## 5. 기술 구현 세부사항

### 5.1 상태 관리
```javascript
// 글로벌 상태
- state: 'initial' | 'korean' | 'hiragana'
- activeCard: 1 | 2 (현재 활성 카드)
- card1State: 'front' | 'back'
- card2State: 'front' | 'back'
- isAnimating: boolean (애니메이션 잠금)
- recentHistory: array (최근 나온 글자들)
```

### 5.2 CSS 클래스 구조
```css
.card.flipped              // 카드 뒤집힘 상태
.card.flipped.slide-out-flipped  // 일본어 보이며 슬라이드 아웃
.card.slide-in             // 한국어 보이며 슬라이드 인
```

### 5.3 Transform 순서 중요
```css
/* 올바른 순서 - translateX 먼저, rotateY 나중 */
transform: translateX(100%) rotateY(180deg);
```

## 6. Git 관리
- Remote repository: `git@personal:vagabondms/hiragana.git`
- 모든 변경사항은 commit 후 push
- Commit 메시지에 Co-Authored-By 포함

## 7. 주요 버그 및 해결사항

### 7.1 카드 전환 시 텍스트 문제
- **문제**: 슬라이드 아웃하는 카드에 한국어가 보임
- **원인**: 두 카드가 같은 상태를 공유
- **해결**: Dual-card system으로 각 카드 독립적 관리

### 7.2 CSS Transform 충돌
- **문제**: animation transform이 기존 transform 덮어씀
- **해결**: 올바른 transform 순서 적용 및 CSS 선택자 특이도 조정

## 8. 향후 개선사항 (Out of Scope)
- 학습 진행도 추적
- 틀린 문제 재학습
- 발음 오디오 재생
- 다른 일본어 문자 추가 (카타카나, 한자)